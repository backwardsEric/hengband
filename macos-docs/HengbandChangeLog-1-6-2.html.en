<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN"
   "http://www.w3.org/TR/1998/REC-html40-19980424/strict.dtd">
<HTML>
  <HEAD lang="en">
    <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <TITLE>Hengband Application for macOS: Changes in 1.6.2 Version</TITLE>
  </HEAD>

  <BODY>
    <H1>Hengband Application for macOS</H1>
    <P><A HREF="index.html.en">Binaries</A> | <A HREF="HengbandEnglishScreenshot.html.en">English screen shot</A> | <A HREF="HengbandJapaneseScreenshot.html.en">Japanese screen shot</A> | <A HREF="HengbandFeedback.html.en">Feedback</A> | <A HREF="HengbandSourceCode.html.en">Source code</A> | <A HREF="HengbandChangeLog.html.en">2.2.1.7 Changes</A> | 1.6.2 Changes
    <H1>Changes</H1>
      <OL>
        <LI>January 24, 2021.  1.6.2b includes the following changes:
        <UL>
          <LI>Include a binary with native support for x86_64 and arm systems.
            I don't have access to an arm-based Mac so it's best to treat
            running natively on an arm-based Mac as an experimental feature.
          <LI>For the Japanese version, fixed bug where an incorrect internal
            sanity check led to some characters not being rendered (most
            obviously in item names in the stores) or to some characters not
            being cleared (seen when switching between screens in the character
            sheet).
          <LI>No longer use Angband 4's versions of the graphical tiles.
            Instead used Hengband's versions converted to PNG with transparency
            added.
          <LI>For Japanese, no longer use Osaka as the default font since it
            is not included with macOS Catalina by default.  Instead, use
            Hiragino Maru Gothic ProN.
          <LI>Don't call Term_activate() from drawRect().  That caused crashes
            with Angband on some versions of macOS.
          <LI>Changed how the fallback preferences for the font name and size
            are set so they'll properly influence the configuration for the
            windows.
          <LI>Allow for the possibility that a rendered character requires
            a surrogate pair when encoded as UTF-16.
          <LI>Fixed regression in the macOS interface:  wasn't considering the
            full GLYPH_COUNT glyphs in updateGlyphInfo().
          <LI>Use VERSION_NAME rather than an explicit "Hengband" in more places
            in the macOS interface.
          <LI>In Term_pict_cocoa(), step through the passed-in arrays in
            increments of the tile width scaling.  Does not matter in the
            current configuration where only one tile at a time is passed to
            Term_pict_cocoa().
          <LI>Made some comment changes and code rearrangements in the macOS
            code so it can be more easily be compared against the code in other
            variants.
          <LI>The executable was compiled on macOS 10.15.7 rather than
            macOS 10.14.6.  If you encounter problems with versions of macOS
            prior to 10.15 or with macOS 10.16, please let me know.
        </UL>
        <LI>April 12, 2020.  Initial release, 1.6.2a.
        <UL>
          <LI>The macOS front end is nearly the same as in 2.2.1.7.  The
            changes are:
            <UL>
              <LI>Fixed bug:  initialize displayed state of the "big tiles"
                setting in the menu from the stored value rather than always
                setting it to true.
              <LI>Configured so the writable game files are put in
                ~/Documents/Hengband-1.6.2.
              <LI>Encoded the splash screen prompt in EUC-JP.
              <LI>Initialized the effective group ID and, for good measure,
                the effective user ID, before calling init_angband().
              <LI>Changed types in terminal hook prototypes to match what's
                in 1.6.2.
            </UL>
          <LI>The core Hengband code is that tagged as 1.6.2 with the following
            changes:
            <UL>
              <LI>Changed the Macintosh portion of readme_eng.txt to only have
                instructions for the macOS version.
              <LI>Changed pref-mac.prf so the keycodes sent by the macOS
                interface are recognized as macro triggers.  Map the keycodes
                sent by the classic interface to the same set of macro triggers
                so most of the same macros can be used for both.
              <LI>Since the macOS front end uses Angband's versions of the
                tile sets, conditonally include workarounds for the differences
                in graf-xxx.prf and graf-new.prf.
              <LI>If the MACH_O_COCOA preprocessor macro is set, skip the
                contents of main.c, allow both Unix and Mac line endings, and
                disable both PRIVATE_USER_PATH and SAVEFILE_USE_UID.
              <LI>Included habu's November 18, 2012 change in the master branch
                to configure fixed-size integer types using stdint.h.
              <LI>Avoided compiler warnings by replacing instances of
                fprintf(fd, s) with fputs(s, fd) as had been done in the
                master branch.
              <LI>Avoided compiler warning about 32-bit integers passed to
                long integer format specifiers by adding casts, changing the
                specifier, or changing the type of a local variable.  Made
                similar changes for msg_format() and format().
              <LI>Ported over PHO's February 2020 patch to 2.2.1.7 for
                a --with-varpath option to configure.  Added
                create_needed_dirs() for creating the writeable directories
                as necessary.  Used create_needed_dirs() rather than the
                previous local function in main.c.
              <LI>Included deskull's August 12, 2011 change from the master
                branch for curses compatibility.
              <LI>Changed to update the inventory window after eating a wand
                or staff from the pack.
              <LI>Only check for out-of-date temporary files if the save file
                name is not an empty string.  Avoids spurious warnings when
                creating a new character from the macOS front end.
              <LI>Made changes for compatibility with modern versions of
                autoconf and automake.  Those included habu's January 5, 2010
                change on the master branch.
              <LI>Included lib/help/faq.txt and bootstrap in the output
                generated by <CODE>make dist</CODE>.
            </UL>
      </OL>
  </BODY>
</HTML>
